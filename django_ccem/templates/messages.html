{% extends 'ccem_sim/base.html' %}

{% block content %}

{% include 'form_filter.html' %}

<table class="table table-striped table-bordered">
<tr>
	<th style="width:200px"><span class="glyphicon chevron-down"></span>Date</th>
	<th style="width:500px">Message</th>
	<th style="width:150px">Contact</th>
	<th>Health Unit</th>
</tr>
{% for m in messages %}
<tr>
	<td>{{ m.created }}</td>
	<td onclick="showHideMessagePanel('ele_{{ m.id }}')">
		<span class="alert alert-{% if not m.has_error %}info{% else %}danger{% endif %}">{{ m.message.text }}</span>
		<span class="glyphicon glyphicon-{% if m.is_submission %}ok-sign{% else %}question-sign{% endif %}"></span>
		<div class="panel panel-default" style="display:none" id="ele_{{ m.id }}">
		  <div class="panel-body">
		  	<ul>
		    {% for r in m.report_set.all %}
		    	<li>{{ r.response.text }}</li>
		    {% empty %}
		    	<li>No Report</li>
		    {% endfor %}
		</ul>
	</td>
	<td><a href="{{request.path}}?contact={{m.message.connection.identity}}">{{ m.message.connection.identity }}</a></td>
	<td>{{m.message.connection.dhis2_contact.contact.facility}}</td>
</tr>
{% endfor %}
</table>

<div class='pager'>

{% if messages.has_previous %}
	<li><a href='?page={{ messages.previous_page_number }}'>Previous</a></li>
{% else  %}
	<li class='disabled'><a href='#'>Previous</a><li>
{% endif %}

{% if messages.paginator.num_pages > 1 %}
Page<form action='#', method='get'>
	<input type='text' name='page' value='{{messages.number}}'/>
	<input type='submit' value='Go'/>
	</form> of {{messages.paginator.num_pages }}
{% else %}
	Page {{messages.number }} of 1
{% endif %}

{% if messages.has_next %}
	<li><a href='?page={{ messages.next_page_number }}'>Next</a></li>
{% else  %}
	<li class='disabled'><a href='#'>Next</a></li>
{% endif %}


{% endblock %}
